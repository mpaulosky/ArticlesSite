@inherits LayoutComponentBase
@implements IDisposable

<div class="antialiased bg-theme-neutral-400 text-theme-neutral-900 dark:bg-theme-neutral-800 dark:text-theme-neutral-100 transition-colors duration-300">
	<div class="flex flex-col min-h-screen space-y-4">
		<NavMenuComponent />

		<main class="container flex-1 max-w-7xl px-4 mx-auto space-y-2 xl:max-w-7xl">
			<ErrorBoundary>
				<ChildContent>
					@Body
				</ChildContent>

				<ErrorContent>
					<!-- Error UI -->
					<div id="blazor-error-ui" class="hidden fixed
					bottom-0 left-0 right-0 z-50 bg-theme-accent-100 dark:bg-theme-accent-900 shadow-lg
					border-t-2 border-theme-accent-400 dark:border-theme-accent-600 px-5 py-3 transition-colors duration-200" data-nosnippet>
						<div class="flex items-center justify-between">
							<span class="text-theme-neutral-900 dark:text-theme-neutral-100">
								An unhandled error has occurred.
								<a href="." class="text-theme-primary-600 dark:text-theme-primary-400 hover:underline ml-2">Reload</a>
							</span>
							<button class="btn-warning" onclick="document.getElementById('blazor-error-ui')">
								🗙
							</button>
						</div>
					</div>
				</ErrorContent>
			</ErrorBoundary>
		</main>
		<footer>
			<FooterComponent />
		</footer>

	</div>
</div>

@code {

	private bool _initialized;

	protected override Task OnAfterRenderAsync(bool firstRender)
  {
    if (firstRender && !_initialized)
		{
			_initialized = true;
			StateHasChanged();
		}

    return Task.CompletedTask;
  }

	private static int GetErrorCode(Exception? exception)
	{
		if (exception is null)
			return 500;

		return exception switch
		{
			UnauthorizedAccessException => 401,
			ArgumentException => 400,
			KeyNotFoundException => 404,
			_ => 500
		};
	}

	public void Dispose()
	{
		// Cleanup if needed
	}

}
